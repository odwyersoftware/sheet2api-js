!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).Sheet2API=e()}(this,(function(){"use strict";const t="https://sheet2api.com/v1/";function e(e,n){let o="";return e.startsWith(t)?o+=e:o+=t+e,n&&void 0!==n.sheet&&(o+=n.sheet+"/",delete n.sheet),n&&void 0!==n.query&&(o+="?"+function(t){const e=[];for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e.join("&")}(n.query)),o}function n(t,n,o,s=null){let i;return i=null==s?o?"POST":"GET":s,new Promise((function(s,u){const r=new XMLHttpRequest,a=e(t,n);r.open(i,a,!0),r.onload=function(){this.status>=200&&this.status<300?s(JSON.parse(r.responseText)):u({status:this.status,statusText:r.statusText})},r.setRequestHeader("Content-Type","application/json; charset=UTF-8"),function(t,e){if(e&&void 0!==e.auth){const n=e.auth[0],o=e.auth[1];t.setRequestHeader("Authorization","Basic "+btoa(`${n}:${o}`))}}(r,n),r.onerror=function(t){u(t)},o?r.send(JSON.stringify(o)):r.send()}))}return{read:n,write:n,update:function(t,e,o){return n(t,e,o,"PUT")},updatePartial:function(t,e,o){return n(t,e,o,"PATCH")},version:"1.0"}}));
